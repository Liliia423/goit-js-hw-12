{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '45378122-3aa1f0accb7d59cfaae2c348a';\nconst BASE_URL = 'https://pixabay.com/api/';\n\n\n\nexport async function requestSending(query, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 15,\n        page, \n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error('Error in requestSending:', error.message);\n    throw new Error(`HTTP error! ${error.message}`);\n  }\n}","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport function markupSearchForm() {\n  const tegMain = document.querySelector('main');\n\n  const tegForm = document.createElement('form');\n  tegForm.className = 'search-image-form';\n\n  const tegInput = document.createElement('input');\n  tegInput.type = 'text';\n  tegInput.name = 'field';\n  tegInput.className = 'search-field';\n  tegInput.placeholder = 'Search images...';\n  tegForm.appendChild(tegInput);\n\n  const tegButton = document.createElement('button');\n  tegButton.textContent = 'Search';\n  tegButton.type = 'submit';\n  tegButton.className = 'submit-button';\n  tegForm.appendChild(tegButton);\n\n  tegMain.prepend(tegForm);\n}\n\nexport function renderGallery(images) {\n  const gallery = document.querySelector('.gallery');\n  const markup = images.map(image => \n    `\n    <li>\n    \n      <a href=\"${image.largeImageURL}\" title=\"${image.tags}\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />  \n      </a>\n       <div class=\"gallery-info\">\n        <p class=\"gallery-info-item\"><b>Likes:</b> ${image.likes}</p>\n        <p class=\"gallery-info-item\"><b>Views:</b> ${image.views}</p>\n        <p class=\"gallery-info-item\"><b>Comments:</b> ${image.comments}</p>\n        <p class=\"gallery-info-item\"><b>Downloads:</b> ${image.downloads}</p>\n      </div>\n    </li>\n  `\n).join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  lightbox.refresh();\n}\n\nexport function markupLoadButton() {\n  const gallery = document.querySelector('.gallery');\n\n  const loadMoreButton = document.createElement('button');\n  loadMoreButton.textContent = 'Load more';\n  loadMoreButton.type = 'button'; \n  loadMoreButton.className = 'submit-button load-more-button';\n  loadMoreButton.style.display = 'none'; \n\n  const loader = document.createElement('div');\n  loader.className = 'loader';\n  loader.style.display = 'none'; \n\n  gallery.insertAdjacentElement('afterend', loadMoreButton);\n  \n  loadMoreButton.insertAdjacentElement('afterend', loader);\n}\n\n \n ","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { requestSending } from './js/pixabay-api';\nimport { markupSearchForm, renderGallery, markupLoadButton } from './js/render-functions';\n\nmarkupSearchForm();\nmarkupLoadButton();\n\nconst searchForm = document.querySelector('.search-image-form');\nconst searchField = document.querySelector('.search-field');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst maxPages = 5; \n\nlet page = 1; \nlet currentQuery = ''; \n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction showLoadMoreButton() {\n  const loadMoreButton = document.querySelector('.load-more-button');\n  if (loadMoreButton) {\n    loadMoreButton.style.display = 'block';\n  }\n}\n\nfunction hideLoadMoreButton() {\n  const loadMoreButton = document.querySelector('.load-more-button');\n  if (loadMoreButton) {\n    loadMoreButton.style.display = 'none';\n  }\n}\n\nfunction scrollToNextPage() {\n  const galleryItem = document.querySelector('.gallery li'); \n \n  if (galleryItem) {\n    const itemHeight = galleryItem.getBoundingClientRect().height; \n    const scrollHeight = 2 * itemHeight; \n    window.scrollBy({\n      top: scrollHeight,\n      behavior: 'smooth', \n    });\n  }\n}\n\n\nsearchForm.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  const query = searchField.value.trim();\n\n  if (!query) {\n    return;\n  }\n\n  currentQuery = query;\n  page = 1; \n  gallery.innerHTML = '';\n  hideLoadMoreButton();\n  showLoader();\n\n  try {\n    const data = await requestSending(query, page);\n    if (data.hits.length === 0) {\n      throw new Error('No results found');\n    }\n \n    renderGallery(data.hits);\n    scrollToNextPage(); \n\n    if (data.totalHits > page * 15) {\n      showLoadMoreButton();\n    } else {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        class: 'info-toast',\n        timeout: 4000,\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      message: 'Sorry, there are no images matching your search query. Please try again.',\n      position: 'topRight',\n      class: 'error-toast',\n      timeout: 4000,\n    });\n  } finally {\n    hideLoader();\n  }\n\n  searchField.value = '';\n});\n\nconst loadMoreButton = document.querySelector('.load-more-button');\nloadMoreButton.addEventListener('click', async () => {\n  if (page >= maxPages) {\n    hideLoadMoreButton();\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results (test mode).\",\n      position: 'topRight',\n      class: 'info-toast',\n      timeout: 4000,\n    });\n    return;\n  }\n\n  page += 1;\n  showLoader();\n  hideLoadMoreButton();\n\n  try {\n    const data = await requestSending(currentQuery, page);\n    renderGallery(data.hits);\n    //loader check\n    /*const data = await new Promise((resolve) => {\n      setTimeout(async () => {\n        const result = await requestSending(currentQuery, page);\n        resolve(result);\n      }, 3000); \n    });\n    renderGallery(data.hits);*/\n\n    if (data.totalHits <= page * 15 || page >= maxPages) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        class: 'info-toast',\n        timeout: 4000,\n      });\n    } else {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    iziToast.error({\n      message: 'An error occurred while loading more images. Please try again.',\n      position: 'topRight',\n      class: 'error-toast',\n      timeout: 4000,\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\n"],"names":["API_KEY","BASE_URL","requestSending","query","page","axios","error","markupSearchForm","tegMain","tegForm","tegInput","tegButton","renderGallery","images","gallery","markup","image","SimpleLightbox","markupLoadButton","loadMoreButton","loader","searchForm","searchField","maxPages","currentQuery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","scrollToNextPage","galleryItem","scrollHeight","event","data","iziToast"],"mappings":"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"}